
<h3>{% trans "Help tenants find your site" %}</h3>
<div class="col-xs-12 pade_none co_form_con">
    <div class="col-xs-12 pade_none">
        <div class="col-sm-12 col-md-12 col-xs-12 pade_none cowok_leftcon">
            <h4>{% trans "Select your location on the map" %}</h4>
            <div class="col-xs-12 pade_none type_text_cowork">{% trans "Enter your SpacesMap field in the space, and select your SpacesMapsite in the pop-up drop-down list. If you do not have your sitedisplay drop-down list, please search the site where the streetstry. " %}</div>

            <div class="col-xs-12 pade_none coworker_loaction_grey_panel">
                <input id="autocomplete" name="autocomplete" type="text" placeholder="在这里输入您的创客云图场地名、所属城市和所在街道" onkeypress="return searchByStationName(event)">

            </div>
        </div>

        <div class="col-sm-12 col-md-12 col-xs-12 pade_none2 pade_none">
            <div class="col-sm-12 col-md-12 col-xs-12 pade_none spacemap_text_bott">

                <div id="space_map" style="height:300px;"></div>

                <p>{% trans "Check the location is correct. If there is a mistake, pleasechange to the correct position" %}</p>
            </div>
        </div>
    </div>
    <div class="col-xs-12 pade_none">&nbsp;</div>
    <h4>{% trans "Next step" %}</h4>
    <p>{% trans "Complete the information below." %}</p>
    <div class="col-xs-12 pade_none coworker_event_bottom_panel">
        <div class="col-xs-12 pade_none">
            <div class="col-sm-6 col-md-6 col-xs-12 pade_none cowok_leftcon">
                <label>{% trans "Place names *" %}:</label>
                <input id="location_name" name="location_name" type="text" value="coworker">
            </div>
            <div class="col-sm-6 col-md-6 col-xs-12 pade_none cowok_rgtcon">
                <label>{% trans "Unit number and floor" %} :</label>
                <input name="unit" type="text">
            </div>
        </div>
        <div class="col-xs-12 pade_none">
            <div class="col-sm-6 col-md-6 col-xs-12 pade_none cowok_leftcon">
                <div class="form-group ui-front">
                    <label>{% trans "Street 1*" %}:</label>
                    <input id="address" name="address" type="text" class="submission_form_inner input" data-fv-field="address">
                    <small class="help-block" data-fv-validator="notEmpty" data-fv-for="address" data-fv-result="NOT_VALIDATED" style="display: none;">{% trans "Required" %}</small></div>
            </div>
            <div class="col-sm-6 col-md-6 col-xs-12 pade_none cowok_rgtcon">
                <div class="form-group">
                    <label>{% trans "City *" %}:</label>
                    <input id="address_sec" name="address_sec" type="text" class="submission_form_inner input">
                </div>
            </div>
        </div>
        <div class="col-xs-12 pade_none">
            <div class="col-sm-6 col-md-6 col-xs-12 pade_none cowok_leftcon">
                <div class="form-group ui-front">
                    <label>Town / City*:</label>
                    <input id="city" name="city" type="text" class="submission_form_inner input ui-autocomplete-input" value="kiev" data-fv-field="city" autocomplete="off">
                    <input id="f_city" name="f_city" type="hidden" value="kiev">
                    <small class="help-block" data-fv-validator="notEmpty" data-fv-for="city" data-fv-result="NOT_VALIDATED" style="display: none;">{% trans "The city is required" %}</small><ul class="ui-autocomplete ui-front ui-menu ui-widget ui-widget-content" id="ui-id-4" tabindex="0" style="display: none;"></ul></div>
            </div>
            <div class="col-sm-6 col-md-6 col-xs-12 pade_none cowok_rgtcon">
                <div>
                    <label>{% trans "City Proper" %}:</label>
                    <input id="area" name="area" type="text">
                    <input id="cityLat" name="cityLat" type="hidden" value="50.4501">
                    <input id="cityLng" name="cityLng" type="hidden" value="30.5234">
                </div>
            </div>
        </div>
        <div class="col-xs-12 pade_none">
            <div class="col-sm-6 col-md-6 col-xs-12 pade_none cowok_leftcon">
                <div id="stateField" class="form-group ui-front" style="display:none;">
                    <label>State:</label>
                    <select id="state_id" name="state_id" class="meet_icon" style="display: none;"></select><span class="custom-combobox"><input id="state" name="state" title="" class="custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left ui-autocomplete-input" autocomplete="off" data-fv-field="state"><a tabindex="-1" title="Show All Items" class="ui-button ui-widget ui-state-default ui-button-icon-only custom-combobox-toggle ui-corner-right" role="button"><span class="ui-button-icon-primary ui-icon ui-icon-triangle-1-s"></span><span class="ui-button-text"></span></a></span> 
                    <ul class="ui-autocomplete ui-front ui-menu ui-widget ui-widget-content" id="ui-id-3" tabindex="0" style="display: none;"></ul><small class="help-block" data-fv-validator="notEmpty" data-fv-for="state" data-fv-result="NOT_VALIDATED" style="display: none;">{% trans "The state is required" %}</small></div>
            </div>
        </div>
        <div class="col-xs-12 pade_none">
            <div class="col-sm-6 col-md-6 col-xs-12 pade_none cowok_leftcon">
                <div class="form-group">
                    <label>{% trans "Postal Code" %}:</label>
                    <input id="postal_code" name="postal_code" type="text">
                </div>
            </div>
        </div>
{#        <div class="col-xs-12 pade_none">#}
{#            <div class="col-sm-6 col-md-6 col-xs-12 pade_none cowok_leftcon">#}
{#                <div id="countryField" class="form-group ui-front">#}
{#                    <label>Country:</label>#}
{#                    <select id="country_id" name="country_id" class="meet_icon" style="display: none;"></select><span class="custom-combobox"><input id="country" name="country" title="" class="custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left ui-autocomplete-input" autocomplete="off" data-fv-field="country"><a tabindex="-1" title="Show All Items" class="ui-button ui-widget ui-state-default ui-button-icon-only custom-combobox-toggle ui-corner-right" role="button"><span class="ui-button-icon-primary ui-icon ui-icon-triangle-1-s"></span><span class="ui-button-text"></span></a></span>#}
{#                    <ul class="ui-autocomplete ui-front ui-menu ui-widget ui-widget-content" id="ui-id-2" tabindex="0" style="display: none;"></ul><small class="help-block" data-fv-validator="notEmpty" data-fv-for="country" data-fv-result="NOT_VALIDATED" style="display: none;">{% trans "The country is required" %}</small></div>#}
{#            </div>#}
{#        </div>#}
    </div>
</div>

<script type="text/javascript"
        src="http://api.map.baidu.com/api?key=&amp;v=1.2&amp;services=true"></script>

<script type="text/javascript">
  // <![CDATA[
  //Create and initialize the map£º
  function initMap() {
    createMap();
    setMapEvent();
    addMapControl();
    addMarker();
  }

  //Create a map function£º
  function createMap() {
    var map = new BMap.Map("space_map");//Add a map to the container
    var point = new BMap.Point(123.455123,41.79223);//set the center point
    map.centerAndZoom(point, 19);//display level
    window.map = map;
    window.localSearch = new BMap.LocalSearch(map);
    window.localSearch.enableAutoViewport(); //Allow automatic adjustment
  }

  // control tool of the map£º
  function setMapEvent() {
    map.enableDragging();
    map.enableScrollWheelZoom();
    map.enableDoubleClickZoom();
    map.enableKeyboard();
  }

  function searchByStationName() {
    map.clearOverlays();//Empty the original annotation
    var keyword = document.getElementById("autocomplete").value;
    window.localSearch.setSearchCompleteCallback(function (searchResult) {
      var poi = searchResult.getPoi(0);
{#      document.getElementById("result_").value = poi.point.lng + "," + poi.point.lat;#}
      map.centerAndZoom(poi.point, 15);
      var marker = new BMap.Marker(new BMap.Point(poi.point.lng, poi.point.lat));  // Create a label£¬ to match coordinate
      map.addOverlay(marker);
      var content = document.getElementById("autocomplete").value + "<br/><br/>longitude£º" + poi.point.lng + "<br/>latitude£º" + poi.point.lat;
      var infoWindow = new BMap.InfoWindow("<p style='font-size:14px;'>" + content + "</p>");

      document.getElementById("city").value = poi.city;
      document.getElementById("address").value = poi.address;
      document.getElementById("postal_code").value = poi.postcode;

      marker.addEventListener("click", function () {
        this.openInfoWindow(infoWindow);
      });
      // marker.setAnimation(BMAP_ANIMATION_BOUNCE); //Beating animation
    });
    window.localSearch.search(keyword);
  }

  //addMapControl£º
  function addMapControl() {
    var ctrl_nav = new BMap.NavigationControl({
      anchor : BMAP_ANCHOR_TOP_LEFT,
      type : BMAP_NAVIGATION_CONTROL_LARGE
    });
    map.addControl(ctrl_nav);
    //Scale controls
    var ctrl_sca = new BMap.ScaleControl({
      anchor : BMAP_ANCHOR_BOTTOM_LEFT
    });
    map.addControl(ctrl_sca);
  }

  //Indexing array
  var markerArr = [ {
    title : "Pentagon",
    content : "tel£º18823879110<br/>address£ºnew york",
    point : "123.455123|41.79223",
    isOpen : 1,
    icon : {
      w : 21,
      h : 21,
      l : 0,
      t : 21,
      x : 6,
      lb : 5
    }
  } ];
  // creat marker
  function addMarker() {
    for ( var i = 0; i < markerArr.length; i++) {
      var json = markerArr[i];
      var p0 = json.point.split("|")[0];
      var p1 = json.point.split("|")[1];
      var point = new BMap.Point(p0, p1);
      var iconImg = createIcon(json.icon);
      var marker = new BMap.Marker(point, {
        icon : iconImg
      });
      var iw = createInfoWindow(i);
      var label = new BMap.Label(json.title, {
        "offset" : new BMap.Size(json.icon.lb - json.icon.x + 10, -20)
      });
      marker.setLabel(label);
      map.addOverlay(marker);
      label.setStyle({
        borderColor : "#808080",
        color : "#333",
        cursor : "pointer"
      });

      (function() {
        var index = i;
        var _iw = createInfoWindow(i);
        var _marker = marker;
        _marker.addEventListener("click", function() {
          this.openInfoWindow(_iw);
        });
        _iw.addEventListener("open", function() {
          _marker.getLabel().hide();
        })
        _iw.addEventListener("close", function() {
          _marker.getLabel().show();
        })
        label.addEventListener("click", function() {
          _marker.openInfoWindow(_iw);
        })
        if (!!json.isOpen) {
          label.hide();
          _marker.openInfoWindow(_iw);
        }
      })()
    }
  }
  //creat InfoWindow
  function createInfoWindow(i) {
    var json = markerArr[i];
    var iw = new BMap.InfoWindow(
      "<b class='iw_poi_title' title='" + json.title + "'>"
      + json.title + "</b><div class='iw_poi_content'>"
      + json.content + "</div>");
    return iw;
  }
  //creat Icon
  function createIcon(json) {
    var icon = new BMap.Icon(
      "http://api.map.baidu.com/img/markers.png",
      new BMap.Size(json.w, json.h), {
        imageOffset : new BMap.Size(-json.l, -json.t),
        infoWindowOffset : new BMap.Size(json.lb + 5, 1),
        offset : new BMap.Size(json.x, json.h)
      })
    return icon;
  }

  initMap();//Create and initialize the map
  // ]]>
</script>
