{% extends 'pages/inner_main.html' %}
{% load i18n %}
{% load sekizai_tags %}

{% block body_css %} no-nav-banners three-col logged-in user-style-comalex3 AdaptiveSearchPage AdaptiveDefaultPage supports-drag-and-drop {% endblock %}
{% block inner_content %}

    <div class="Grid-cell u-size2of3 u-lg-size3of4">
        <div id="map_canvas" style="height: 777px; position: relative; overflow: hidden;">
    </div>


    <script>
      document.map = L.map('map_canvas').setView([50.449, 30.5243], 13);

      L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
        '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
        'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
        id: 'mapbox.streets'
      }).addTo(document.map);

      {% for obj in object_list %}
        {% if obj.lng and  obj.lat %}
          L.marker([{{ obj.lat }}, {{ obj.lng }}]).addTo(document.map).bindPopup(
            "<b>{{ obj.name }}</b></br><img src='{{ obj.get_main_photo }}' width=100 height=100>")
            {% if not forloop.last %}, {% endif %}
        {% endif %}

      {% endfor %}
      var popup = L.popup();

      {#      var#}
      {#      map.fitBounds([#}
      {#        [40.712, -74.227],#}
      {#        [40.774, -74.125]#}
      {#      ]);#}
      function onMapClick(e) {
        popup
          .setLatLng(e.latlng)
          .setContent("You clicked the map at " + e.latlng.toString())
          .openOn(mymap);
      }
      mymap.on('click', onMapClick);

    </script>
{% endblock %}
